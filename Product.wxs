<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" 
           Name="STS50 Backup Agent" 
           Language="1033" 
           Version="$(var.Version)" 
           Manufacturer="STS50 Cloud Backup" 
           UpgradeCode="A1B2C3D4-E5F6-7890-ABCD-EF1234567890">
    
    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />
    <MajorUpgrade DowngradeErrorMessage="A newer version is already installed." />
    <MediaTemplate EmbedCab="yes" />
    
    <Feature Id="ProductFeature" Title="STS50 Backup Agent" Level="1">
      <ComponentGroupRef Id="AgentComponents" />
      <ComponentRef Id="ServiceComponent" />
    </Feature>
    
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFiles64Folder">
        <Directory Id="INSTALLFOLDER" Name="STS50 Backup Agent">
          <Component Id="ServiceComponent" Guid="B2C3D4E5-F6A7-8901-BCDE-F23456789012">
            <ServiceInstall Id="ServiceInstaller"
                           Type="ownProcess"
                           Name="STS50BackupAgent"
                           DisplayName="STS50 Backup Agent"
                           Description="STS50 Cloud Backup Agent Service"
                           Start="auto"
                           Account="LocalSystem"
                           ErrorControl="normal" />
            <ServiceControl Id="StartService" Start="install" Stop="both" Remove="uninstall" Name="STS50BackupAgent" Wait="yes" />
          </Component>
        </Directory>
      </Directory>
    </Directory>
  </Product>
</Wix>